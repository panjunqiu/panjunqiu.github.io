# 五线谱识谱练习

一个基于 React 的交互式五线谱识谱练习应用，帮助音乐学习者系统化提高识谱能力和反应速度。

## ✨ 功能特性

### 🎵 核心功能
- **随机音符练习**：系统随机生成 C4-A5 范围内的音符，涵盖13个音符（do-la₅）
- **实时反馈**：答题后立即显示正确/错误反馈，答对自动进入下一题
- **键盘快捷键**：支持13个键盘快捷键（A-Shift），快速答题
- **虚拟钢琴**：提供可视化的钢琴键盘界面，支持鼠标点击
- **音频播放**：使用 Web Audio API 生成真实音符声音
  - 答题时播放选择的音符声音
  - 显示答案时播放正确音符声音
  - 学习模块中点击音符卡片播放声音

### 🎯 练习模式
- **自由练习**：无时间限制，自由练习，适合初学者
- **定时练习**：支持多种时长选择
  - 预设时长：10/20/30分钟
  - 自定义时长：1-120分钟任意设置
  - 倒计时显示：实时显示剩余时间
  - 自动结束：时间到自动保存练习记录
- **答错提示**：答错时显示正确答案，需确认后继续，强化记忆
- **显示答案**：提供"显示答案"按钮，不确定时可查看正确答案并听音

### 📚 学习模块
- **音符学习**：展示所有13个音符的完整列表
- **可视化展示**：每个音符显示五线谱图像、唱名和音名
- **交互式学习**：点击音符卡片播放对应声音
- **学习提示**：提供学习建议和使用指南
- **响应式布局**：自适应不同屏幕尺寸

### 📊 数据统计
- **本次练习统计**：记录当前练习的详细数据
  - 每个音符的答题数、正确数、正确率
  - 平均反应时间统计
  - 实时更新统计数据
- **汇总统计**：累计所有练习的历史数据
  - 跨会话数据持久化
  - 长期学习进度追踪
- **练习记录**：保存每次练习的完整记录
  - 练习时间和日期
  - 总分、正确率、最高连对数
  - 练习时长（定时练习）
  - 每个音符的详细统计
  - 支持展开查看详细数据
  - 一键清空所有记录

### 📈 统计展示
- **卡片模式**：美观的卡片布局
  - 包含五线谱音符图像
  - 显示唱名和音名
  - 彩色进度指示
  - 悬停动画效果
- **表格模式**：清晰的表格展示
  - 支持多维度排序
  - 按答题数排序
  - 按正确率排序
  - 按平均反应时间排序
  - 点击表头切换升序/降序
- **三标签切换**：本次练习、汇总统计、练习记录

### 📱 实时数据
- **计分板**：顶部显示关键指标
  - 总题数
  - 正确数
  - 正确率（百分比）
  - 连对数（连续答对题数）
- **音符统计**：每个音符的详细数据
  - 答题数、正确数、正确率
  - 平均反应时间（精确到0.01秒）
  - 五线谱可视化显示
- **反应时间追踪**：记录每次答题的反应时间

## 🛠️ 技术栈

### 核心技术
- **前端框架**：React 18.2.0
  - 使用 Hooks（useState, useEffect）管理状态
  - 函数式组件开发
  - 组件化架构设计
- **构建工具**：Webpack 5.89.0
  - Babel 转译 JSX 和 ES6+
  - 开发服务器热更新
  - 生产环境代码优化
- **样式方案**：Tailwind CSS 3.3.5
  - 实用优先的 CSS 框架
  - 响应式设计
  - 渐变色和动画效果
- **开发语言**：JavaScript (JSX)

### 技术实现细节

#### 音频系统
- **Web Audio API**：生成真实音符声音
  - 使用 OscillatorNode 生成正弦波
  - GainNode 控制音量和淡出效果
  - 精确的音符频率映射（A4=440Hz标准）
  - 支持13个音符的完整音域

#### 状态管理
- **React Hooks**：
  - `useState`：管理组件状态（分数、统计、定时器等）
  - `useEffect`：处理副作用（键盘事件、定时器）
- **数据持久化**：
  - 练习记录保存在组件状态中
  - 支持跨会话的统计数据累计

#### 五线谱渲染
- **SVG 绘图**：
  - 动态计算音符位置
  - 标准五线谱规则实现
  - 支持加线（上加线、下加一线）
  - 高音谱号显示

#### 交互设计
- **键盘事件**：
  - 全局键盘监听
  - 13个快捷键映射
  - 防止重复触发
- **定时器系统**：
  - 精确的倒计时实现
  - 自动保存练习记录
  - 时间格式化显示

#### 数据统计算法
- **实时统计**：
  - 每个音符独立统计
  - 反应时间精确记录
  - 正确率动态计算
- **排序功能**：
  - 多字段排序支持
  - 升序/降序切换
  - 表格模式实时排序

## 快速开始

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

应用将在 `http://localhost:3000` 启动

### 构建生产版本
```bash
npm run build
```

构建产物将输出到 `dist` 目录

## 使用说明

### 键盘快捷键
- `A` - do (C4)
- `S` - re (D4)
- `D` - mi (E4)
- `F` - fa (F4)
- `G` - sol (G4)
- `H` - la (A4)
- `J` - si (B4)
- `K` - do₅ (C5)
- `L` - re₅ (D5)
- `;` - mi₅ (E5)
- `'` - fa₅ (F5)
- `Enter` - sol₅ (G5)
- `Shift` - la₅ (A5)

### 练习流程
1. 观察五线谱上显示的音符
2. 通过点击钢琴键或按键盘快捷键选择答案
3. 查看反馈结果
4. 答错时确认正确答案后继续
5. 答对时自动进入下一题

### 定时练习
1. 点击"定时练习"按钮
2. 选择预设时长或输入自定义时长
3. 练习结束后自动保存记录

### 查看统计
1. 点击"数据统计"按钮
2. 切换"本次练习"/"汇总统计"/"练习记录"标签
3. 在统计视图中切换"卡片模式"/"表格模式"
4. 点击表头进行排序（表格模式）

## 📱 应用布局结构

### 整体布局
应用采用单页面设计，从上到下依次包含以下区域：

```
┌─────────────────────────────────────┐
│         标题区域                     │
│   "五线谱识谱练习"                   │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│         计分板区域                   │
│  总题数 | 正确数 | 正确率 | 连对数   │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│         五线谱显示区域               │
│    [五线谱图像 + 音符]              │
│    [正确答案显示]（答错时）          │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│         虚拟钢琴键盘                 │
│  [13个白键，显示唱名和快捷键]       │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│         功能按钮区域                 │
│  定时练习 | 重新开始 | 数据统计     │
│  学习模块 | 显示答案                │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│      扩展面板区域（可折叠）          │
│  - 定时器设置面板                   │
│  - 学习模块面板                     │
│  - 数据统计面板                     │
│  - 键盘快捷键说明                   │
└─────────────────────────────────────┘
```

### 核心区域说明

#### 1. 标题区域
- 应用名称和简短说明
- 渐变色标题设计
- 固定在页面顶部

#### 2. 计分板区域
- 4个统计卡片横向排列
- 实时显示练习数据
- 渐变色背景，视觉突出

#### 3. 五线谱显示区域
- 标准五线谱图像（SVG渲染）
- 当前需要识别的音符
- 答题反馈（✓ 或 ✗）
- 答错时显示正确答案（可点击播放声音）

#### 4. 虚拟钢琴键盘
- 13个白键横向排列
- 每个键显示唱名和快捷键
- 支持鼠标点击和键盘输入
- 答题时禁用状态

#### 5. 功能按钮区域
- 定时练习：开启定时模式
- 重新开始：重置当前练习
- 数据统计：查看统计数据
- 学习模块：学习音符知识
- 显示答案：查看当前题目答案

#### 6. 扩展面板区域
根据用户操作动态显示不同面板：

**定时器设置面板**
- 预设时长按钮（10/20/30分钟）
- 自定义时长输入框
- 倒计时显示

**学习模块面板**
- 13个音符卡片网格布局
- 每个卡片包含：五线谱图像、唱名、音名
- 点击播放对应音符声音
- 学习提示和使用建议

**数据统计面板**
- 三个标签页：本次练习、汇总统计、练习记录
- 两种展示模式：卡片模式、表格模式
- 支持多维度排序
- 练习记录详情展开

**键盘快捷键说明**
- 13个快捷键的映射关系
- 网格布局展示

## 🎯 使用流程

### 基础练习流程

```
开始练习
    ↓
观察五线谱上的音符
    ↓
选择答案（点击琴键或按快捷键）
    ↓
查看反馈结果
    ↓
┌─────────┬─────────┐
│  答对    │  答错    │
└─────────┴─────────┘
    ↓           ↓
自动进入   查看正确答案
下一题         ↓
    ↓      点击"确定"
    ↓           ↓
    └───────────┘
         ↓
    继续练习
```

### 定时练习流程

```
点击"定时练习"按钮
    ↓
选择练习时长
├─ 预设时长（10/20/30分钟）
└─ 自定义时长（1-120分钟）
    ↓
开始练习（显示倒计时）
    ↓
正常答题练习
    ↓
时间结束
    ↓
自动保存练习记录
    ↓
查看本次练习统计
```

### 学习模式流程

```
点击"学习模块"按钮
    ↓
浏览所有音符列表
    ↓
点击任意音符卡片
    ↓
播放对应音符声音
    ↓
观察五线谱位置
    ↓
记忆唱名和音名
    ↓
熟悉后开始练习
```

### 数据统计查看流程

```
点击"数据统计"按钮
    ↓
选择统计类型
├─ 本次练习：当前会话的统计
├─ 汇总统计：所有历史累计
└─ 练习记录：历史练习列表
    ↓
选择展示模式
├─ 卡片模式：可视化展示
└─ 表格模式：详细数据表格
    ↓
查看详细数据
├─ 每个音符的统计
├─ 正确率和反应时间
└─ 练习记录详情
    ↓
分析学习进度
```

### 答题辅助流程

```
遇到不确定的题目
    ↓
点击"显示答案"按钮
    ↓
查看正确答案
    ↓
播放音符声音
    ↓
记忆音符特征
    ↓
继续练习
```

### 完整练习周期

```
1. 学习阶段
   └─ 使用学习模块熟悉音符

2. 自由练习
   └─ 不限时间，熟悉操作

3. 定时练习
   └─ 设定时长，集中训练

4. 数据分析
   └─ 查看统计，找出弱项

5. 针对性练习
   └─ 重点练习正确率低的音符

6. 循环提升
   └─ 重复以上步骤，持续进步
```

## 💡 使用技巧

### 初学者建议
1. **先学习后练习**：使用学习模块熟悉每个音符的位置和声音
2. **从慢到快**：先自由练习，熟练后再使用定时模式
3. **善用显示答案**：不确定时及时查看答案，避免错误记忆
4. **关注弱项**：通过统计数据找出正确率低的音符，重点练习

### 进阶技巧
1. **键盘快捷键**：熟练使用键盘快捷键，提高答题速度
2. **定时挑战**：设定时间目标，提升反应速度
3. **数据分析**：定期查看统计数据，了解学习进度
4. **连对记录**：挑战更高的连对数，保持专注度

### 练习建议
1. **每日练习**：建议每天练习10-20分钟，保持手感
2. **分段练习**：可以分多次练习，避免疲劳
3. **记录进步**：定期查看练习记录，见证自己的进步
4. **循序渐进**：从简单音符开始，逐步扩展到全部音符

## 🎼 音符范围

应用支持以下13个音符的练习：

### 中音区（7个音符）
- **do (C4)**：下加一线，261.63 Hz
- **re (D4)**：第一线下方间，293.66 Hz
- **mi (E4)**：第一线，329.63 Hz
- **fa (F4)**：第一间，349.23 Hz
- **sol (G4)**：第二线，392.00 Hz
- **la (A4)**：第二间，440.00 Hz（标准音）
- **si (B4)**：第三线，493.88 Hz

### 高音区（6个音符）
- **do₅ (C5)**：第三间，523.25 Hz
- **re₅ (D5)**：第四线，587.33 Hz
- **mi₅ (E5)**：第四间，659.25 Hz
- **fa₅ (F5)**：第五线，698.46 Hz
- **sol₅ (G5)**：第五线上方间，783.99 Hz
- **la₅ (A5)**：上加一线，880.00 Hz

## 🌟 特色功能

### 智能统计系统
- **分音符统计**：独立追踪每个音符的练习情况
- **反应时间分析**：精确记录每次答题的反应时间（毫秒级）
- **正确率追踪**：实时计算和显示每个音符的正确率
- **趋势分析**：通过历史数据了解学习进度
- **弱项识别**：快速发现需要加强练习的音符

### 练习记录管理
- **自动保存**：每次练习结束自动保存记录
- **详细记录**：包含时间、分数、统计等完整信息
- **历史查看**：支持查看所有历史练习记录
- **展开详情**：可展开查看每个音符的详细统计
- **记录清空**：支持一键清空所有历史记录

### 学习辅助功能
- **音符学习**：独立的学习模块，展示所有音符
- **音频反馈**：点击播放真实音符声音
- **显示答案**：不确定时可查看正确答案
- **错误强化**：答错时必须确认正确答案

### 用户体验设计
- **渐变色彩**：现代化的渐变色设计
- **流畅动画**：按钮悬停、点击等交互动画
- **响应式布局**：适配桌面、平板、手机等设备
- **直观反馈**：清晰的视觉和音频反馈
- **无障碍设计**：支持键盘快捷键操作

### 性能优化
- **轻量级实现**：纯前端应用，无需后端
- **快速响应**：即时的答题反馈
- **内存优化**：高效的状态管理
- **浏览器兼容**：支持现代浏览器

## 💻 开发说明

### 依赖说明
- **React 18.2.0**：用于构建用户界面
  - 使用 Hooks API 进行状态管理
  - 函数式组件开发模式
- **Webpack 5.89.0**：模块打包和开发服务器
  - 支持热更新（HMR）
  - 代码分割和优化
- **Babel 7.23.5**：JSX和ES6+语法转换
  - @babel/preset-react：React JSX 转换
  - @babel/preset-env：ES6+ 语法转换
- **Tailwind CSS 3.3.5**：实用优先的CSS框架
  - 响应式设计工具类
  - 自定义主题配置
- **PostCSS 8.4.31**：CSS处理工具
  - Autoprefixer：自动添加浏览器前缀

### 开发环境配置
- **Node.js**：建议使用 14.x 或更高版本
- **包管理器**：npm 或 yarn
- **开发端口**：默认 3000，可在 `webpack.config.js` 中修改
- **浏览器要求**：支持 ES6+ 和 Web Audio API 的现代浏览器

### 代码规范
- **组件命名**：使用 PascalCase（如 MusicStaff）
- **文件命名**：组件文件使用 .jsx 扩展名
- **样式方案**：优先使用 Tailwind 工具类
- **状态管理**：使用 React Hooks
- **代码格式**：建议使用 ESLint 和 Prettier

### 构建优化
- **生产构建**：自动压缩和优化代码
- **代码分割**：按需加载组件
- **资源优化**：CSS 和 JS 文件压缩
- **缓存策略**：文件名哈希用于长期缓存

### 扩展建议
- **数据持久化**：可集成 localStorage 或 IndexedDB
- **用户系统**：可添加用户登录和云端同步
- **更多音符**：可扩展到更宽的音域范围
- **难度等级**：可添加不同难度的练习模式
- **成就系统**：可添加徽章和成就系统

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

### 贡献指南
1. Fork 本仓库
2. 创建特性分支（`git checkout -b feature/AmazingFeature`）
3. 提交更改（`git commit -m 'Add some AmazingFeature'`）
4. 推送到分支（`git push origin feature/AmazingFeature`）
5. 开启 Pull Request

### 问题反馈
如果您发现任何问题或有改进建议，请：
- 提交 Issue 描述问题
- 提供复现步骤
- 附上截图或错误信息

## 📮 联系方式

如有任何问题或建议，欢迎通过 Issue 联系我们。

---

**祝您练习愉快，早日成为识谱高手！** 🎵🎹
